<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Sales Dashboard</title>

  <!-- CDN for Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <script>
    Chart.register(ChartDataLabels);
  </script>

  <!-- Absolute paths since index.html is served from "/" -->
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <h2>Sales Dashboard</h2>

  <div id="topRow" class="controls"
     style="display:flex; align-items:center; gap:6px; flex-wrap:wrap;">

    <!-- Category buttons -->
    <div id="catBtns" style="display:flex; gap:6px; flex-wrap:wrap;">
      <button class="btn active" data-val="ALL">All</button>
      <button class="btn" data-val="PCLT">PCLT</button>
      <button class="btn" data-val="TBR">TBR</button>
      <button class="btn" data-val="18PLUS">18+ Inch</button>
      <button class="btn" data-val="ISEG">EV/iSeg</button>
      <button class="btn" data-val="SUV">SUV</button>
      <button class="btn" data-val="LOWPROFILE">Low profile / Strategic TBR</button>
      <button class="btn" data-val="HM">HM</button>
    </div>
    
    <div id="metricBtns" class="controls" style="gap:6px; margin-left:50px;">
      <button class="btn" data-metric="qty">Qty</button>
      <button class="btn" data-metric="amount">Amount</button>
    </div>
    <label style="gap:6px; margin-left:50px;">Group By:</label>
      <select id="group_by">
        <option value="region" selected>Region</option>
        <option value="salesman">Salesman</option>
        <option value="sold_to_group">Sold-to Group</option>
        <option value="sold_to">Sold-to</option>
        <option value="product_group">Product Group</option>
      </select>
    <div id="viewSwitch"
        style="margin-left:auto; display:flex; gap:6px;">
      <button class="btn active ">Graph View</button>
      <button class="btn" onclick="window.location.href='/map'">Map View</button>
    </div>
   
  </div>

  <div class="controls">
    <div id="regionBtns" class="controls" style="gap:6px;">
      <button class="btn" data-val="ALL">ALL</button>
      <button class="btn" data-val="NSW">NSW</button>
      <button class="btn" data-val="QLD">QLD</button>
      <button class="btn" data-val="VIC">VIC</button>
      <button class="btn" data-val="WA">WA</button>
    </div>

    <label>Salesman:</label>
    <select id="salesman_name"><option value="ALL">ALL</option></select>

    <label>Sold-to Group:</label>
    <select id="sold_to_group"><option value="ALL">ALL</option></select>

    <div id="topCustomerControls" class="controls">
      <button class="btn active" data-limit="0">All</button>
      <button class="btn" data-limit="10">Top 10</button>
      <button class="btn" data-limit="20">Top 20</button>
      <button class="btn" data-limit="30">Top 30</button>
    </div>

    <label for="sold_to">Sold-to:</label>
    <input type="text" id="sold_to" placeholder="Search Sold-to..." list="sold_to_list" />
    <datalist id="sold_to_list"></datalist>

    <!-- NEW: Ship-to (enabled only after Sold-to is chosen) -->
    <label style="margin-left:8px;">Ship-to:</label>
    <input list="ship_to_list" id="ship_to" placeholder="Search Ship-to..." />
    <datalist id="ship_to_list"></datalist>


    <label>Product Group:</label>
    <select id="product_group"><option value="ALL">ALL</option></select>

    <!-- NEW: Pattern (list filtered by Product Group) -->
    <label style="margin-left:8px;">Pattern:</label>
    <input list="pattern_list" id="pattern" placeholder="Search Pattern" />
    <datalist id="pattern_list"></datalist>
    
</body>
</html>  


  <!-- region/BDE KPI table -->
  <table id="kpiByRegion" class="kpi-table"></table>
  <div class="box"><h3>Profit (Monthly)</h3><div class="chart-fixed"><canvas id="profitComboChart"></canvas></div></div></div>
  </div>
    
  <!-- ROW 1: Daily -->
  <div class="chart-row" style="margin-top:4px;">
    <div class="box"><h3 id="dailyTitle">Daily Sales</h3><canvas id="dailyChart"></canvas></div>
    <div class="box"><h3>Stacked Daily</h3><canvas id="stackedDailyChart"></canvas></div>
    <div class="box"><h3>Stacked Daily %</h3><canvas id="stackedDailyPercentChart"></canvas></div>
  </div>

  <!-- ROW 2: Daily cumulative -->
  <div class="chart-row" style="margin-top:4px;">
    <div class="box"><h3 id="cumTitle">Cumulative Sales (Daily)</h3><canvas id="dailyCumChart"></canvas></div>
    <div class="box"><h3>Stacked Cumulative</h3><canvas id="stackedDailyCumChart"></canvas></div>
    <div class="box"><h3>Stacked Cumulative %</h3><canvas id="stackedDailyCumPercentChart"></canvas></div>
  </div>



  <!-- ROW 3: base 2 charts Monthly -->
  <div class="chart-row" style="margin-top:4px;">
    <div class="box"><h3>Monthly Sales</h3><canvas id="monthlyChart"></canvas></div>
    <div class="box"><h3>Stacked Monthly</h3><canvas id="stackedMonthlyChart"></canvas></div>
    <div class="box"><h3>Stacked Monthly %</h3><canvas id="stackedMonthlyPercentChart"></canvas></div>  
  </div>

  <!-- ROW 4: stacked 2 charts Monthly -->
  <div class="chart-row" style="margin-top:4px;">
    <div class="box"><h3>Cumulative by Month</h3><canvas id="monthlyCumChart"></canvas></div>
    <div class="box"><h3>Stacked Cumulative by Month</h3><canvas id="stackedMonthlyCumChart"></canvas></div>
    <div class="box"><h3>Stacked Cumulative by Month %</h3><canvas id="stackedMonthlyCumPercentChart"></canvas></div>
  </div>

  <!-- ROW 5: Yearly -->
  <div class="chart-row" style="margin-top:4px;">
    <div class="box"><h3 id="yearlyTitle">Yearly Sales</h3><canvas id="yearlyChart"></canvas></div>
    <div class="box"><h3>Stacked Yearly</h3><canvas id="stackedYearlyChart"></canvas></div>
    <div class="box"><h3>Stacked Yearly %</h3><canvas id="stackedYearlyPercentChart"></canvas></div>
  </div>

  <!-- tiny error bar to surface API issues -->
  <div id="errbar" class="errbar" hidden></div>

  <script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
></script>
  <script src="/static/app.js" defer></script>
</body>
</html>
